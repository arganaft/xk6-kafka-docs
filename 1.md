при вызове sql запроса в postgresql:
DO $$
DECLARE
    ids BIGINT[];
    id BIGINT;
BEGIN
    FOR i IN 1..100 LOOP
        -- Имитируем параллельные вызовы
        PERFORM pg_sleep(0.01);
        SELECT murex.get_next_batch_id(10) INTO id;
        ids := array_append(ids, id);
    END LOOP;
    
    -- Проверяем уникальность
    IF array_length(ids, 1) = COUNT(DISTINCT unnest(ids)) THEN
        RAISE NOTICE 'Все ID уникальны!';
    ELSE
        RAISE EXCEPTION 'Обнаружены дубликаты ID!';
    END IF;
END $$;

появляется ошибка:
SQL Error [0A000]: ERROR: aggregate function calls cannot contain set-returning function calls
  Подсказка: You might be able to move the set-returning function into a LATERAL FROM item.
  Где: PL/pgSQL function inline_code_block line 14 at IF

Позиция ошибки:
